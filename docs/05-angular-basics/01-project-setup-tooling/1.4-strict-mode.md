# 1.4 Strict Mode & TypeScript Config

**Branch: `1-4-strict-mode-typescript-config`**

Strict mode enforces type safety, catches errors early, and ensures production-ready code quality. Angular CLI generates strict configs by default in new projects.

## Enable Strict Mode

**tsconfig.json (root level):**

```json
{
  "compilerOptions": {
    "strict": true, // Enables ALL strict options
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noImplicitOverride": true, // Angular 15+
    "noPropertyAccessFromIndexSignature": true,
    "noUncheckedIndexedAccess": true, // Angular 16+
    "strictNullChecks": true,
    "useUnknownInCatchVariables": true // Angular 16+
  },
  "angularCompilerOptions": {
    "strictTemplates": true, // Template type checking
    "strictInjectionParameters": true
  }
}
```

## Angular CLI Strict Configuration

**angular.json:**

```json
{
  "projects": {
    "main-app": {
      "architect": {
        "build": {
          "builder": "@angular-devkit/build-angular:application",
          "options": {
            "strictTemplates": true
          }
        },
        "lint": {
          "builder": "@angular-eslint/builder:lint",
          "options": {
            "strict": true
          }
        }
      }
    }
  }
}
```

## TypeScript Config Breakdown

### Core Strict Flags

```json
{
  "strict": true, // Master switch (enables below)
  "noImplicitAny": true, // No implicit 'any' types
  "strictNullChecks": true, // null/undefined checking
  "strictFunctionTypes": true, // Function parameter bivariance
  "strictBindCallApply": true, // bind/call/apply checking
  "noImplicitThis": true, // No implicit 'this' type
  "useUnknownInCatch": true // catch(e) typed as unknown
}
```

### Template Strictness

```json
{
  "angularCompilerOptions": {
    "strictTemplates": true, // Full template type checking
    "strictInjectionParameters": true, // DI parameter checking
    "strictInputAccessModifiers": true,
    "strictOutputEventTypes": true,
    "strictDomLocalRefTypes": true, // #hero template refs
    "strictAttributeTypes": true // [attr] bindings
  }
}
```

## Practical Strict Mode Examples

### Before Strict (Broken Code)

```typescript
// ❌ Errors in strict mode
function greet(name) {
  // name: any
  return `Hello ${name.toUpperCase()}`; // Property 'toUpperCase' does not exist on type 'any'
}

try {
  throw new Error("boom");
} catch (e) {
  // e: any
  console.log(e.message); // Unsafe
}
```

### After Strict (Safe Code)

```typescript
// ✅ Strict mode compliant
function greet(name: string): string {
  return `Hello ${name.toUpperCase()}`;
}

try {
  throw new Error("boom");
} catch (e: unknown) {
  if (e instanceof Error) {
    console.log(e.message); // Type safe
  }
}
```

## ESLint Configuration (.eslintrc.json)

```json
{
  "extends": [
    "plugin:@angular-eslint/recommended",
    "plugin:@angular-eslint/template/process-inline-templates"
  ],
  "rules": {
    "@angular-eslint/no-empty-lifecycle-method": "error",
    "@angular-eslint/use-lifecycle-interface": "warn",
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/strict-boolean-expressions": "warn"
  }
}
```

## Prettier Configuration (.prettierrc)

```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 100,
  "tabWidth": 2
}
```

## EditorConfig (.editorconfig)

```
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.md]
trim_trailing_whitespace = false
```

## Verify Strict Mode Setup

**Test these error cases:**

```typescript
// Should ALL error in strict mode:
let x: any;
x.foo(); // ❌ Property 'foo' does not exist

const hero = null!;
hero.name; // ❌ Object is possibly 'null'

function fn(x?: string) {
  return x.length; // ❌ Object is possibly 'undefined'
}
```

**Checklist for completion:**

- [ ] `tsc --noEmit` shows type errors
- [ ] `ng build` fails on type errors
- [ ] Template errors show in VS Code
- [ ] ESLint catches Angular-specific issues
- [ ] Prettier formats on save

## Package.json Scripts

```json
{
  "scripts": {
    "type-check": "tsc --noEmit",
    "lint:fix": "ng lint --fix",
    "format": "prettier --write .",
    "strict-check": "npm run type-check && ng lint"
  }
}
```

## VS Code Settings (.vscode/settings.json)

```json
{
  "typescript.preferences.quoteStyle": "single",
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "angular.enable-strict-mode-prompt": false
}
```

**✅ Complete when:**

- [ ] All strict flags enabled in `tsconfig.json`
- [ ] `ng build` fails on type errors
- [ ] Template type checking works in VS Code
- [ ] ESLint + Prettier pipeline configured
- [ ] `npm run strict-check` passes clean code

**Demo verification:**

```
1-4-strict-mode-typescript-config/
├── tsconfig.json                 # Strict mode enabled
├── tsconfig.app.json            # App-specific config
├── .eslintrc.json               # Angular ESLint
├── .prettierrc                  # Formatting
└── .vscode/settings.json        # Editor config
```

**Next: `1-5-environment-management.md`** - Production, staging, dev configs!

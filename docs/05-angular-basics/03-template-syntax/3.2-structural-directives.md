# Structural Directives

In Angular, structural directives are the "architects" of your HTMLâ€”they don't just change the look of an element; they **add or remove elements from the DOM** entirely.

### The Core Difference

Structural directives are easy to spot because they modify the layout.

* **Old Approach:** Uses the asterisk (`*`) prefix, which is "syntactic sugar" for the `<ng-template>` element.
* **Modern Approach (Angular 17+):** Uses **Built-in Control Flow**, which is more performant, readable, and doesn't require imports in your standalone components.

---

### 1. Conditional Rendering (`if`)

This is used when you only want to show an element if a specific condition is met.

#### Old Approach: `*ngIf`

```html
<div *ngIf="isLoggedIn; else loggedOut">
  Welcome back, User!
</div>

<ng-template #loggedOut>
  Please sign in.
</ng-template>

```

#### Modern Approach: `@if`

The syntax is cleaner and behaves like standard JavaScript. No more "else" templates required.

```typescript
@if (isLoggedIn) {
  <p>Welcome back, User!</p>
} @else {
  <button>Sign In</button>
}

```

---

### 2. Rendering Lists (`for`)

Used to loop through an array and generate a template for each item.

#### Old Approach: `*ngFor`

You often had to use `trackBy` functions to improve performance, which felt a bit clunky.

```html
<ul>
  <li *ngFor="let item of items; let i = index">
    {{ i }}: {{ item.name }}
  </li>
</ul>

```

#### Modern Approach: `@for`

The modern `@for` loop is significantly faster. **Note:** The `track` property is now **mandatory**, which forces better performance habits.

```typescript
<ul>
  @for (item of items; track item.id) {
    <li>{{ item.name }}</li>
  } @empty {
    <li>No items found in the list.</li>
  }
</ul>

```

> **Pro Tip:** The `@empty` block is a new addition that automatically displays content if the array is empty.

**context variables**.

Instead of the `let i = index` syntax used in `*ngFor`, the modern approach gives you a set of implicit variables that you can alias using the `=` operator. But it is optional, you can directly used the as it is.

### How to use Index and other variables

You can access the index, the count, and even booleans for the first or last items in the list:

```typescript
@for (item of items; track item.id; let i = $index; let total = $count) {
  <div>
    Item #{{ i + 1 }} of {{ total }}: {{ item.name }}
    
    @if ($first) { <span>(Newest)</span> }
    @if ($last) { <span>(Oldest)</span> }
  </div>
}

```

### Available Context Variables

The modern syntax prefixes these variables with a `$` to distinguish them from your data properties:

| Variable | Description |
| --- | --- |
| **`$index`** | The index of the current row. |
| **`$count`** | The total length of the collection. |
| **`$first`** | Boolean: true if the item is the first in the list. |
| **`$last`** | Boolean: true if the item is the last in the list. |
| **`$even`** | Boolean: true if the index is even. |
| **`$odd`** | Boolean: true if the index is odd. |

### Key Syntax Difference

* **Old (`*ngFor`):** Uses the `let` keyword for everything (`let i = index`).
* **Modern (`@for`):** The variables exist automatically as `$index`, `$first`, etc. You only need the `let` keyword if you want to **alias** them to a shorter name (like `let i = $index`).



---

### 3. Multiple Conditions (`switch`)

Used when you have multiple potential outcomes for a single value.

#### Old Approach: `[ngSwitch]`

```html
<div [ngSwitch]="userRole">
  <p *ngSwitchCase="'admin'">Full Access</p>
  <p *ngSwitchCase="'editor'">Limited Access</p>
  <p *ngSwitchDefault>Read Only</p>
</div>

```

#### Modern Approach: `@switch`

```typescript
@switch (userRole) {
  @case ('admin') { <p>Full Access</p> }
  @case ('editor') { <p>Limited Access</p> }
  @default { <p>Read Only</p> }
}

```

---


### The "Star" (`*`) Secret

When you write `*ngIf="condition"`, Angular is actually performing a "de-sugaring" process behind the scenes. It converts that star into a formal template.

**Your code:**

```html
<div *ngIf="isLoaded">Content</div>

```

**What Angular actually renders:**

```html
<ng-template [ngIf]="isLoaded">
  <div>Content</div>
</ng-template>

```

---

### When to use which?

| Feature | Use Case |
| --- | --- |
| **Modern Control Flow (`@if`, `@for`)** | Use this for **99% of your logic**. It's faster, cleaner, and the future of the framework. |
| **Structural Directives (`*ngIf`, `*myCustom`)** | Use these when you want to create **reusable UI logic** (like a `*appPermission` directive) or when using third-party libraries that haven't updated yet. |

### Summary of the "Structural" Family

1. **Directives:** `*ngIf`, `*ngFor`, `*ngSwitchCase`.
2. **Built-in Control Flow:** `@if`, `@for`, `@switch`.
3. **Template Containers:** `<ng-container>` (to group elements without adding a `<div>` to the DOM) and `<ng-template>` (to define a snippet of HTML that doesn't render until told to).

---

### Why the Modern Approach Wins

1. **Performance:** The new control flow can be up to 90% faster during runtime execution.
2. **No Imports:** You don't need to import `CommonModule` or `NgIf/NgFor` anymore.
3. **Better Type Checking:** The compiler can "see" the variables better inside the new blocks.

